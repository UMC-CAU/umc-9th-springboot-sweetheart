// ğŸ—‚ï¸ UMC 9th SpringBoot Project - ERD
// Database Markup Language (DBML) v3.0
//
// ì‚¬ìš©ë²•:
// 1. https://dbdiagram.io/d ì ‘ì†
// 2. ì´ íŒŒì¼ ë‚´ìš© ë³µì‚¬/ë¶™ì—¬ë„£ê¸°
// 3. ìë™ìœ¼ë¡œ ì˜ˆìœ ERD ìƒì„±!
//
// ì„¤ì • ê°€ëŠ¥:
// - ì„  ìŠ¤íƒ€ì¼ (ì§ì„ /ê³¡ì„ )
// - ìƒ‰ìƒ í…Œë§ˆ
// - ê¸€ì”¨ í¬ê¸°
// - ì—”í‹°í‹° ìœ„ì¹˜ (ë“œë˜ê·¸)
// - PNG/PDF/SQL ë‚´ë³´ë‚´ê¸°

// ===========================================
// íšŒì› ë„ë©”ì¸ (Member Domain)
// ===========================================

Table member {
  id bigint [pk, increment, note: 'íšŒì› ID']
  name varchar(50) [not null, note: 'ì´ë¦„']
  gender varchar(10) [not null, default: 'NONE', note: 'MALE, FEMALE, NONE']
  birth date [not null, note: 'ìƒë…„ì›”ì¼']
  address varchar(255) [not null, note: 'ì£¼ì†Œ']
  detail_address varchar(255) [not null, note: 'ìƒì„¸ì£¼ì†Œ']
  social_uid varchar(255) [not null, note: 'ì†Œì…œ ë¡œê·¸ì¸ UID']
  social_type varchar(20) [not null, note: 'KAKAO, NAVER, APPLE, GOOGLE']
  point integer [not null, note: 'í¬ì¸íŠ¸']
  email varchar(100) [not null, note: 'ì´ë©”ì¼']
  phone_number varchar(20) [null, note: 'íœ´ëŒ€í°ë²ˆí˜¸(ì„ íƒ, nullì´ë©´ ë¯¸ì¸ì¦)']
  created_at timestamp [not null, default: `now()`, note: 'ê°€ì…ì¼']
  updated_at timestamp [not null, default: `now()`, note: 'ìˆ˜ì •ì¼']
  deleted_at timestamp [null, note: 'íƒˆí‡´ì¼ (ì†Œí”„íŠ¸ ì‚­ì œ)']

  indexes {
    email [unique]
    social_uid [unique]
  }

  Note: 'íšŒì› ì •ë³´. BaseEntity ìƒì†ìœ¼ë¡œ íƒ€ì„ìŠ¤íƒ¬í”„ ë° ì†Œí”„íŠ¸ ì‚­ì œ ì§€ì›'
}

Table food {
  id bigint [pk, increment]
  name varchar(20) [not null, note: 'KOREAN, CHINESE, JAPANESE, WESTERN, ETC']

  Note: 'ìŒì‹ ì¹´í…Œê³ ë¦¬ (í•œì‹, ì¤‘ì‹, ì¼ì‹, ì–‘ì‹ ë“±)'
}

Table member_food {
  id bigint [pk, increment]
  member_id bigint [not null, ref: > member.id]
  food_id bigint [not null, ref: > food.id]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]

  indexes {
    (member_id, food_id) [unique, note: 'ì¤‘ë³µ ì„ í˜¸ ìŒì‹ ë°©ì§€']
  }

  Note: 'íšŒì›ì´ ì„ í˜¸í•˜ëŠ” ìŒì‹ ë§¤í•‘ í…Œì´ë¸”'
}

Table term {
  id bigint [pk, increment]
  name varchar(20) [not null, note: 'AGE, SERVICE, PRIVACY, LOCATION, MARKETING']

  Note: 'ì•½ê´€ ì¢…ë¥˜ (ì—°ë ¹, ì„œë¹„ìŠ¤, ê°œì¸ì •ë³´, ìœ„ì¹˜, ë§ˆì¼€íŒ…)'
}

Table member_term {
  id bigint [pk, increment]
  member_id bigint [not null, ref: > member.id]
  term_id bigint [not null, ref: > term.id]

  indexes {
    (member_id, term_id) [unique, note: 'ì¤‘ë³µ ë™ì˜ ë°©ì§€']
  }

  Note: 'íšŒì›ì´ ë™ì˜í•œ ì•½ê´€ ë§¤í•‘ í…Œì´ë¸”'
}

// ===========================================
// ê°€ê²Œ ë„ë©”ì¸ (Store Domain)
// ===========================================

Table location {
  location_id bigint [pk, increment, note: 'ì§€ì—­ ID']
  name varchar(50) [not null, note: 'ì§€ì—­ëª… (ì˜ˆ: ì„œìš¸, ê²½ê¸°, ë¶€ì‚°)']

  Note: 'ì§€ì—­ ì •ë³´'
}

Table store {
  store_id bigint [pk, increment]
  name varchar(100) [not null, note: 'ê°€ê²Œëª…']
  manager_number bigint [not null, note: 'ê´€ë¦¬ì ë²ˆí˜¸']
  detail_address varchar(255) [not null, note: 'ìƒì„¸ì£¼ì†Œ']
  location_id bigint [not null, ref: > location.location_id]
  food_id bigint [not null, ref: > food.id, note: 'ê°€ê²Œ ìŒì‹ ì¹´í…Œê³ ë¦¬']

  Note: 'ê°€ê²Œ ì •ë³´. Food FKë¥¼ í†µí•´ í•œì‹ë‹¹/ì¤‘ì‹ë‹¹ ë“±ìœ¼ë¡œ ë¶„ë¥˜'
}

// ===========================================
// ë¯¸ì…˜ ë„ë©”ì¸ (Mission Domain)
// ===========================================

Table mission {
  mission_id bigint [pk, increment]
  name varchar(100) [not null, note: 'ë¯¸ì…˜ëª… (ì˜ˆ: ë°˜ì•„í–¥ìƒë¯¸ë¼íƒ• 10,000ì› ì´ìƒ ì‹ì‚¬)']
  deadline date [not null, note: 'ë§ˆê°ì¼']
  conditional varchar(255) [not null, note: 'ë¯¸ì…˜ ì¡°ê±´']
  point integer [not null, note: 'íšë“ í¬ì¸íŠ¸']
  created_at timestamp [not null, default: `now()`]
  store_id bigint [not null, ref: > store.store_id]

  Note: 'ê°€ê²Œë³„ ë¯¸ì…˜. íšŒì›ì´ ë¯¸ì…˜ ì™„ë£Œ ì‹œ í¬ì¸íŠ¸ ì§€ê¸‰'
}

Table member_mission {
  member_mission_id bigint [pk, increment]
  status varchar(20) [not null, default: 'AVAILABLE', note: 'AVAILABLE, IN_PROGRESS, COMPLETED']
  member_id bigint [not null, ref: > member.id]
  mission_id bigint [not null, ref: > mission.mission_id]

  indexes {
    (member_id, mission_id) [unique, note: 'íšŒì›ë‹¹ ë¯¸ì…˜ 1ë²ˆë§Œ ì°¸ì—¬']
  }

  Note: 'íšŒì›ì˜ ë¯¸ì…˜ ì°¸ì—¬ ìƒíƒœ ê´€ë¦¬'
}

// ===========================================
// ë¦¬ë·° ë„ë©”ì¸ (Review Domain)
// ===========================================

Table review {
  review_id bigint [pk, increment]
  content text [not null, note: 'ë¦¬ë·° ë‚´ìš©']
  created_at timestamp [not null, default: `now()`]
  star float [not null, note: 'ë³„ì  (0.0 ~ 5.0)']
  store_id bigint [not null, ref: > store.store_id]
  user_id bigint [not null, ref: > member.id, note: 'ë¦¬ë·° ì‘ì„±ì']

  indexes {
    store_id
    user_id
  }

  Note: 'ê°€ê²Œ ë¦¬ë·°. ë³„ì  ë° ë‚´ìš© í¬í•¨'
}

Table review_photo {
  review_photo_id bigint [pk, increment]
  photo_url varchar(500) [not null, note: 'ì‚¬ì§„ URL']
  review_id bigint [not null, ref: > review.review_id]

  Note: 'ë¦¬ë·° ì²¨ë¶€ ì‚¬ì§„. 1ê°œ ë¦¬ë·°ë‹¹ ì—¬ëŸ¬ ì‚¬ì§„ ê°€ëŠ¥'
}

Table reply {
  reply_id bigint [pk, increment]
  content text [not null, note: 'ëŒ“ê¸€ ë‚´ìš©']
  review_id bigint [not null, ref: > review.review_id]

  Note: 'ë¦¬ë·°ì— ëŒ€í•œ ëŒ“ê¸€ (ì‚¬ì¥ë‹˜ ë‹µê¸€ ë“±)'
}

// ===========================================
// ê´€ê³„ ìš”ì•½ (Quick Reference)
// ===========================================

// ë‹¤ëŒ€ë‹¤ ê´€ê³„ (Many-to-Many)
// - Member â†” Food (via member_food)
// - Member â†” Term (via member_term)
// - Member â†” Mission (via member_mission)

// ì¼ëŒ€ë‹¤ ê´€ê³„ (One-to-Many)
// - Location â†’ Store
// - Food â†’ Store (ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜)
// - Store â†’ Mission
// - Store â†’ Review
// - Member â†’ Review
// - Review â†’ ReviewPhoto
// - Review â†’ Reply
